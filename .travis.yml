language: generic

before_install:
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then  
        gem install danger
        && brew update
        && brew outdated swiftlint || brew upgrade swiftlint
    ; fi
        
matrix:
  include:
    - script: 
        - bin/fetch-configlet
        - bin/configlet .
        - swiftlint lint --quiet >> lintreport.json
        - ls
        - swift test
      env: JOB=SPM
      os: osx
      osx_image: xcode8.2
    - script:
        - docker run -v `pwd`:/xswift norionomura/sourcekit:302 bash -c "cd /xswift && swift build"
      env: JOB=Linux
      sudo: required
      services: docker

after_success:
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
        danger 
        && ls -al 
        &&  python -m json.tool lintreport.json
    ; fi



